--[[
    STSServerUI FINAL CUSTOM (USER TEMPLATE)
    - Setup: User's ScreenGui Template
    - Close Button: Hides GUI (Enabled = false)
    - Toggle Key: Right Control
    - Features: Game Card, Interactive Profile, Server Tools
]]

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TeleportService = game:GetService("TeleportService")
local MarketplaceService = game:GetService("MarketplaceService")
local HttpService = game:GetService("HttpService")

local Player = Players.LocalPlayer

-- == 1. CLEANUP OLD GUI ==
-- Kita cek dulu ada gak GUI lama, kalau ada kita hapus biar gak numpuk
if Player:WaitForChild("PlayerGui"):FindFirstChild("STSServerUI") then
    Player.PlayerGui.STSServerUI:Destroy()
end

-- == 2. GUI SETUP (YOUR TEMPLATE) ==
local STSServerUI = Instance.new("ScreenGui")
STSServerUI.Name = "STSServerUI"
STSServerUI.ResetOnSpawn = false
STSServerUI.ZIndexBehavior = Enum.ZIndexBehavior.Global
STSServerUI.IgnoreGuiInset = true
STSServerUI.Enabled = false -- Gw set True biar pas execute langsung muncul
STSServerUI.Parent = Player:WaitForChild("PlayerGui")

-- == 3. MAIN FRAME CONSTRUCTION ==
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 580, 0, 340)
MainFrame.Position = UDim2.new(0.5, -290, 0.5, -170)
MainFrame.BackgroundColor3 = Color3.fromRGB(18, 18, 22) -- Dark Theme
MainFrame.BackgroundTransparency = 0.05
MainFrame.BorderSizePixel = 0
MainFrame.ClipsDescendants = true
MainFrame.Parent = STSServerUI

local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 16)
MainCorner.Parent = MainFrame

-- Top Bar
local TopBar = Instance.new("Frame")
TopBar.Size = UDim2.new(1, 0, 0, 40)
TopBar.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
TopBar.BorderSizePixel = 0
TopBar.Parent = MainFrame

local TopCorner = Instance.new("UICorner"); TopCorner.CornerRadius = UDim.new(0, 16); TopCorner.Parent = TopBar
local TopFix = Instance.new("Frame"); TopFix.Size = UDim2.new(1,0,0,10); TopFix.Position = UDim2.new(0,0,1,-10); TopFix.BackgroundColor3 = Color3.fromRGB(30,30,35); TopFix.BorderSizePixel=0; TopFix.Parent=TopBar

local Title = Instance.new("TextLabel")
Title.Text = "STS SERVER HUB"
Title.Font = Enum.Font.GothamBlack
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 14
Title.Size = UDim2.new(0, 200, 1, 0)
Title.Position = UDim2.new(0, 15, 0, 0)
Title.BackgroundTransparency = 1
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.Parent = TopBar

-- >> CLOSE BUTTON LOGIC (HIDE ONLY) <<
local CloseBtn = Instance.new("TextButton")
CloseBtn.Text = "X"
CloseBtn.Size = UDim2.new(0, 30, 0, 30)
CloseBtn.Position = UDim2.new(1, -40, 0.5, -15)
CloseBtn.BackgroundTransparency = 1
CloseBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.TextSize = 18
CloseBtn.Parent = TopBar

CloseBtn.MouseButton1Click:Connect(function()
    STSServerUI.Enabled = false -- Cuma sembunyiin
end)

-- == 4. LEFT PANEL (PROFILE 3D) ==
local LeftPanel = Instance.new("Frame")
LeftPanel.Size = UDim2.new(0, 180, 1, -55)
LeftPanel.Position = UDim2.new(0, 10, 0, 45)
LeftPanel.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
LeftPanel.Parent = MainFrame
local LPC = Instance.new("UICorner"); LPC.CornerRadius = UDim.new(0, 12); LPC.Parent = LeftPanel

local VPContainer = Instance.new("Frame")
VPContainer.Size = UDim2.new(0, 160, 0, 160)
VPContainer.Position = UDim2.new(0.5, -80, 0, 10)
VPContainer.BackgroundColor3 = Color3.fromRGB(15, 15, 18)
VPContainer.Parent = LeftPanel
local VPC = Instance.new("UICorner"); VPC.CornerRadius = UDim.new(0, 12); VPC.Parent = VPContainer

local ViewportFrame = Instance.new("ViewportFrame")
ViewportFrame.Size = UDim2.new(1, 0, 1, 0)
ViewportFrame.BackgroundTransparency = 1
ViewportFrame.Parent = VPContainer
ViewportFrame.Ambient = Color3.fromRGB(255, 255, 255)
ViewportFrame.LightColor = Color3.fromRGB(255, 255, 255)

local WorldModel = Instance.new("WorldModel")
WorldModel.Parent = ViewportFrame
local Camera = Instance.new("Camera")
ViewportFrame.CurrentCamera = Camera
Camera.Parent = ViewportFrame

local function createInfo(text, color, y, font, size)
    local l = Instance.new("TextLabel")
    l.Text = text
    l.Size = UDim2.new(1, -20, 0, 20)
    l.Position = UDim2.new(0, 10, 0, y)
    l.BackgroundTransparency = 1
    l.TextColor3 = color
    l.Font = font
    l.TextSize = size
    l.TextTruncate = Enum.TextTruncate.AtEnd
    l.TextXAlignment = Enum.TextXAlignment.Center
    l.Parent = LeftPanel
end
createInfo(Player.DisplayName, Color3.fromRGB(255, 255, 255), 180, Enum.Font.GothamBold, 16)
createInfo("@" .. Player.Name, Color3.fromRGB(150, 150, 150), 200, Enum.Font.Gotham, 12)
createInfo("ID: " .. Player.UserId, Color3.fromRGB(100, 100, 100), 220, Enum.Font.Gotham, 10)

-- == 5. RIGHT PANEL (GAME INFO & TOOLS) ==
local RightPanel = Instance.new("ScrollingFrame")
RightPanel.Size = UDim2.new(1, -210, 1, -55) 
RightPanel.Position = UDim2.new(0, 200, 0, 45)
RightPanel.BackgroundTransparency = 1
RightPanel.ScrollBarThickness = 2
RightPanel.AutomaticCanvasSize = Enum.AutomaticSize.Y 
RightPanel.CanvasSize = UDim2.new(0, 0, 0, 0)
RightPanel.Parent = MainFrame
local UIList = Instance.new("UIListLayout"); UIList.Parent = RightPanel; UIList.Padding = UDim.new(0, 8); UIList.SortOrder = Enum.SortOrder.LayoutOrder
local UIPad = Instance.new("UIPadding"); UIPad.PaddingRight = UDim.new(0, 5); UIPad.Parent = RightPanel

-- >> GAME CARD <<
local InfoCard = Instance.new("Frame")
InfoCard.LayoutOrder = 1
InfoCard.Size = UDim2.new(1, 0, 0, 70)
InfoCard.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
InfoCard.Parent = RightPanel
local ICC = Instance.new("UICorner"); ICC.CornerRadius = UDim.new(0, 12); ICC.Parent = InfoCard

-- Image
local GameImg = Instance.new("ImageLabel")
GameImg.Size = UDim2.new(0, 70, 0, 70)
GameImg.BackgroundTransparency = 1
GameImg.Image = "rbxthumb://type=GameIcon&id=" .. game.GameId .. "&w=150&h=150"
GameImg.Parent = InfoCard
local GIC = Instance.new("UICorner"); GIC.CornerRadius = UDim.new(0, 12); GIC.Parent = GameImg
local GIFix = Instance.new("Frame"); GIFix.Size=UDim2.new(0,10,1,0); GIFix.Position=UDim2.new(1,-10,0,0); GIFix.BackgroundColor3=Color3.fromRGB(25,25,30); GIFix.BorderSizePixel=0; GIFix.Parent=GameImg

-- Title & Scroll Btn
local TopTextContainer = Instance.new("Frame")
TopTextContainer.Size = UDim2.new(1, -80, 0, 30)
TopTextContainer.Position = UDim2.new(0, 80, 0, 10)
TopTextContainer.BackgroundTransparency = 1
TopTextContainer.Parent = InfoCard

local GameTitleLabel = Instance.new("TextLabel")
GameTitleLabel.Text = "Detecting..."
GameTitleLabel.Size = UDim2.new(1, -40, 1, 0)
GameTitleLabel.BackgroundTransparency = 1
GameTitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
GameTitleLabel.Font = Enum.Font.GothamBold
GameTitleLabel.TextSize = 13
GameTitleLabel.TextXAlignment = Enum.TextXAlignment.Left
GameTitleLabel.TextTruncate = Enum.TextTruncate.AtEnd
GameTitleLabel.Parent = TopTextContainer

local CopyScrollBtn = Instance.new("TextButton")
CopyScrollBtn.Text = "ðŸ“œ"
CopyScrollBtn.Size = UDim2.new(0, 30, 0, 30)
CopyScrollBtn.Position = UDim2.new(1, -30, 0, 0)
CopyScrollBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
CopyScrollBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
CopyScrollBtn.TextSize = 16
CopyScrollBtn.Parent = TopTextContainer
local CSC = Instance.new("UICorner"); CSC.CornerRadius = UDim.new(0, 8); CSC.Parent = CopyScrollBtn

CopyScrollBtn.MouseButton1Click:Connect(function()
    setclipboard(tostring(game.PlaceId))
    CopyScrollBtn.Text = "âœ…"
    task.wait(1)
    CopyScrollBtn.Text = "ðŸ“œ"
end)

local DevLabel = Instance.new("TextLabel")
DevLabel.Text = "Developer: ..."
DevLabel.Size = UDim2.new(1, -80, 0, 20)
DevLabel.Position = UDim2.new(0, 80, 0, 40)
DevLabel.BackgroundTransparency = 1
DevLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
DevLabel.Font = Enum.Font.Gotham
DevLabel.TextSize = 11
DevLabel.TextXAlignment = Enum.TextXAlignment.Left
DevLabel.Parent = InfoCard

task.spawn(function()
    pcall(function()
        local info = MarketplaceService:GetProductInfo(game.PlaceId)
        GameTitleLabel.Text = info.Name .. " (" .. game.PlaceId .. ")"
        local devName = info.Creator and info.Creator.Name or "Unknown"
        DevLabel.Text = "Developer: " .. devName
    end)
end)

-- >> TOOLS <<
local function createHeader(text, order)
    local l = Instance.new("TextLabel"); l.LayoutOrder = order; l.Text = text; l.Size = UDim2.new(1, 0, 0, 25); l.BackgroundTransparency = 1; l.TextColor3 = Color3.fromRGB(255, 255, 255); l.Font = Enum.Font.GothamBlack; l.TextSize = 12; l.TextXAlignment = Enum.TextXAlignment.Left; l.Parent = RightPanel
end
local function createBtn(text, order, color, callback)
    local b = Instance.new("TextButton"); b.LayoutOrder = order; b.Text = text; b.Size = UDim2.new(1, 0, 0, 35); b.BackgroundColor3 = color; b.TextColor3 = Color3.fromRGB(255, 255, 255); b.Font = Enum.Font.GothamSemibold; b.TextSize = 13; b.Parent = RightPanel; local c = Instance.new("UICorner"); c.CornerRadius = UDim.new(0, 10); c.Parent = b
    b.MouseButton1Click:Connect(callback)
    return b
end
local function createTextBox(placeholder, order)
    local t = Instance.new("TextBox"); t.LayoutOrder = order; t.PlaceholderText = placeholder; t.Text = ""; t.Size = UDim2.new(1, 0, 0, 35); t.BackgroundColor3 = Color3.fromRGB(35, 35, 40); t.TextColor3 = Color3.fromRGB(255, 255, 255); t.Font = Enum.Font.Gotham; t.TextSize = 13; t.Parent = RightPanel; local c = Instance.new("UICorner"); c.CornerRadius = UDim.new(0, 10); c.Parent = t
    return t
end

createHeader("SERVER MANAGER", 2)
createBtn("Rejoin Server", 3, Color3.fromRGB(50, 50, 55), function() TeleportService:TeleportToPlaceInstance(game.PlaceId, game.JobId, Player) end)
createBtn("Copy Job ID (This Server)", 4, Color3.fromRGB(50, 50, 55), function() setclipboard(game.JobId) end)

createHeader("JOIN BY JOB ID", 5)
local JobBox = createTextBox("Paste Job ID here...", 6)
createBtn("Join Job ID", 7, Color3.fromRGB(40, 120, 80), function() if JobBox.Text ~= "" then TeleportService:TeleportToPlaceInstance(game.PlaceId, JobBox.Text, Player) end end)

createHeader("SERVER HOP", 8)
createBtn("Hop Low Server (Sepi)", 9, Color3.fromRGB(0, 160, 100), function()
    local PlaceID = game.PlaceId; local AllIDs = {}
    local function ListServers(Cursor)
        local Raw = game:HttpGet("https://games.roblox.com/v1/games/" .. PlaceID .. "/servers/Public?sortOrder=Asc&limit=100" .. (Cursor and "&cursor=" .. Cursor or ""))
        local Decode = HttpService:JSONDecode(Raw)
        if Decode.nextPageCursor then ListServers(Decode.nextPageCursor) end
        for _, v in pairs(Decode.data) do
            if v.playing < v.maxPlayers and v.playing < 5 and v.id ~= game.JobId then table.insert(AllIDs, v.id) end
        end
    end
    pcall(function() ListServers() end)
    if #AllIDs > 0 then TeleportService:TeleportToPlaceInstance(PlaceID, AllIDs[math.random(1, #AllIDs)], Player) end
end)
createBtn("Hop Random Server", 10, Color3.fromRGB(140, 0, 215), function()
    local PlaceID = game.PlaceId; local AllIDs = {}
    pcall(function()
        local Raw = game:HttpGet("https://games.roblox.com/v1/games/" .. PlaceID .. "/servers/Public?sortOrder=Asc&limit=100")
        local Decode = HttpService:JSONDecode(Raw)
        for _, v in pairs(Decode.data) do if v.playing < v.maxPlayers and v.id ~= game.JobId then table.insert(AllIDs, v.id) end end
    end)
    if #AllIDs > 0 then TeleportService:TeleportToPlaceInstance(PlaceID, AllIDs[math.random(1, #AllIDs)], Player) end
end)

-- == 6. INTERACTIVE CHARACTER ==
local function updateCharacter()
    for _, v in pairs(WorldModel:GetChildren()) do v:Destroy() end
    local char = Player.Character or Player.CharacterAdded:Wait(); if not char then return end
    char.Archivable = true; local clone = char:Clone(); clone.Parent = WorldModel
    local hrp = clone:WaitForChild("HumanoidRootPart"); clone:SetPrimaryPartCFrame(CFrame.new(0, 0, 0))
    for _, item in pairs(clone:GetDescendants()) do if item:IsA("Script") or item:IsA("LocalScript") or item:IsA("Sound") then item:Destroy() end end
end
task.spawn(updateCharacter)

local isDragging, prevX, rotX, zoom = false, 0, 0, 5
local sensitivity = 0.01

VPContainer.InputBegan:Connect(function(input) if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then isDragging = true; prevX = input.Position.X end end)
VPContainer.InputEnded:Connect(function(input) if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then isDragging = false end end)
VPContainer.InputChanged:Connect(function(input)
    if isDragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        local delta = input.Position.X - prevX; rotX = rotX - (delta * sensitivity); prevX = input.Position.X
    end
    if input.UserInputType == Enum.UserInputType.MouseWheel then zoom = math.clamp(zoom - input.Position.Z, 3, 8) end
end)
RunService.RenderStepped:Connect(function()
    local camPos = CFrame.Angles(0, rotX, 0) * CFrame.new(0, 1.5, -zoom)
    Camera.CFrame = CFrame.new(camPos.Position, Vector3.new(0, 1.5, 0))
end)

-- == 7. TOGGLE KEYBIND (RIGHT CONTROL) ==
UserInputService.InputBegan:Connect(function(input, gpe)
    if not gpe and input.KeyCode == Enum.KeyCode.RightControl then
        STSServerUI.Enabled = not STSServerUI.Enabled
    end
end)

print("STS Hub (User Template + Toggle) Loaded")
