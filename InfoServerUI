local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TeleportService = game:GetService("TeleportService")
local MarketplaceService = game:GetService("MarketplaceService")
local HttpService = game:GetService("HttpService")
local Stats = game:GetService("Stats") -- Service untuk Ping & Memory

local Player = Players.LocalPlayer

-- == 1. CLEANUP OLD GUI ==
if Player:WaitForChild("PlayerGui"):FindFirstChild("STSServerUI") then
    Player.PlayerGui.STSServerUI:Destroy()
end

-- == 2. GUI SETUP ==
local STSServerUI = Instance.new("ScreenGui")
STSServerUI.Name = "Info ServerUI"
STSServerUI.DisplayOrder = 9999
STSServerUI.ResetOnSpawn = false
STSServerUI.ZIndexBehavior = Enum.ZIndexBehavior.Global
STSServerUI.IgnoreGuiInset = true
STSServerUI.Enabled = false 
STSServerUI.Parent = Player:WaitForChild("PlayerGui")

-- == 3. MAIN FRAME ==
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 420, 0, 260)
MainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
MainFrame.BackgroundColor3 = Color3.fromRGB(18, 18, 22)
MainFrame.BackgroundTransparency = 0.05
MainFrame.BorderSizePixel = 0
MainFrame.ClipsDescendants = true
MainFrame.Parent = STSServerUI

local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 12)
MainCorner.Parent = MainFrame

local TopBar = Instance.new("Frame")
TopBar.Size = UDim2.new(1, 0, 0, 30)
TopBar.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
TopBar.BorderSizePixel = 0
TopBar.Parent = MainFrame

local TopCorner = Instance.new("UICorner");
TopCorner.CornerRadius = UDim.new(0, 12); TopCorner.Parent = TopBar
local TopFix = Instance.new("Frame"); TopFix.Size = UDim2.new(1,0,0,10); TopFix.Position = UDim2.new(0,0,1,-10); TopFix.BackgroundColor3 = Color3.fromRGB(30,30,35); TopFix.BorderSizePixel=0;
TopFix.Parent=TopBar

local Title = Instance.new("TextLabel")
Title.Text = "InfoServer | Profile"
Title.Font = Enum.Font.GothamBlack
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 12
Title.Size = UDim2.new(0, 200, 1, 0)
Title.Position = UDim2.new(0, 12, 0, 0)
Title.BackgroundTransparency = 1
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.Parent = TopBar

local CloseBtn = Instance.new("TextButton")
CloseBtn.Text = "X"
CloseBtn.Size = UDim2.new(0, 25, 0, 25)
CloseBtn.Position = UDim2.new(1, -30, 0, 3)
CloseBtn.BackgroundTransparency = 1
CloseBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.TextSize = 14
CloseBtn.Parent = TopBar
CloseBtn.MouseButton1Click:Connect(function() STSServerUI.Enabled = false end)

-- == 4. LEFT PANEL ==
local LeftPanel = Instance.new("Frame")
LeftPanel.Size = UDim2.new(0, 130, 1, -40)
LeftPanel.Position = UDim2.new(0, 8, 0, 35)
LeftPanel.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
LeftPanel.Parent = MainFrame
local LPC = Instance.new("UICorner");
LPC.CornerRadius = UDim.new(0, 10); LPC.Parent = LeftPanel

local VPContainer = Instance.new("Frame")
VPContainer.Size = UDim2.new(0, 110, 0, 110)
VPContainer.Position = UDim2.new(0.5, -55, 0, 8)
VPContainer.BackgroundColor3 = Color3.fromRGB(15, 15, 18)
VPContainer.Parent = LeftPanel
local VPC = Instance.new("UICorner");
VPC.CornerRadius = UDim.new(0, 10); VPC.Parent = VPContainer

local ViewportFrame = Instance.new("ViewportFrame")
ViewportFrame.Size = UDim2.new(1, 0, 1, 0)
ViewportFrame.BackgroundTransparency = 1
ViewportFrame.Parent = VPContainer
ViewportFrame.Ambient = Color3.fromRGB(255, 255, 255)
ViewportFrame.LightColor = Color3.fromRGB(255, 255, 255)

local WorldModel = Instance.new("WorldModel");
WorldModel.Parent = ViewportFrame
local Camera = Instance.new("Camera"); ViewportFrame.CurrentCamera = Camera; Camera.Parent = ViewportFrame

local function createInfo(text, color, y, font, size)
    local l = Instance.new("TextLabel")
    l.Text = text
    l.Size = UDim2.new(1, -10, 0, 15)
    l.Position = UDim2.new(0, 5, 0, y)
    l.BackgroundTransparency = 1
    l.TextColor3 = color
    l.Font = font
    l.TextSize = size
    l.TextTruncate = Enum.TextTruncate.AtEnd
    l.TextXAlignment = Enum.TextXAlignment.Center
    l.Parent = LeftPanel
end
createInfo(Player.DisplayName, Color3.fromRGB(255, 255, 255), 125, Enum.Font.GothamBold, 12)
createInfo("@" .. Player.Name, Color3.fromRGB(150, 150, 150), 140, Enum.Font.Gotham, 10)
createInfo("ID: " .. Player.UserId, Color3.fromRGB(100, 100, 100), 155, Enum.Font.Gotham, 9)

-- == 5. RIGHT PANEL ==
local RightPanel = Instance.new("ScrollingFrame")
RightPanel.Size = UDim2.new(1, -150, 1, -40) 
RightPanel.Position = UDim2.new(0, 142, 0, 35)
RightPanel.BackgroundTransparency = 1
RightPanel.ScrollBarThickness = 2
RightPanel.AutomaticCanvasSize = Enum.AutomaticSize.Y 
RightPanel.CanvasSize = UDim2.new(0, 0, 0, 0)
RightPanel.Parent = MainFrame
local UIList = Instance.new("UIListLayout");
UIList.Parent = RightPanel; UIList.Padding = UDim.new(0, 6); UIList.SortOrder = Enum.SortOrder.LayoutOrder
local UIPad = Instance.new("UIPadding"); UIPad.PaddingRight = UDim.new(0, 5);
UIPad.Parent = RightPanel

-- >> GAME CARD <<
local InfoCard = Instance.new("Frame")
InfoCard.LayoutOrder = 1
InfoCard.Size = UDim2.new(1, 0, 0, 65)
InfoCard.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
InfoCard.Parent = RightPanel
local ICC = Instance.new("UICorner");
ICC.CornerRadius = UDim.new(0, 10); ICC.Parent = InfoCard

local GameImg = Instance.new("ImageLabel")
GameImg.Size = UDim2.new(0, 55, 0, 55)
GameImg.Position = UDim2.new(0, 5, 0, 5)
GameImg.BackgroundTransparency = 1
GameImg.Image = "rbxthumb://type=GameIcon&id=" .. game.GameId .. "&w=150&h=150"
GameImg.Parent = InfoCard
local GIC = Instance.new("UICorner");
GIC.CornerRadius = UDim.new(0, 10); GIC.Parent = GameImg

local GameTitleLabel = Instance.new("TextLabel")
GameTitleLabel.Text = "Detecting..."
GameTitleLabel.Size = UDim2.new(1, -70, 0, 18)
GameTitleLabel.Position = UDim2.new(0, 68, 0, 5)
GameTitleLabel.BackgroundTransparency = 1
GameTitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
GameTitleLabel.Font = Enum.Font.GothamBold
GameTitleLabel.TextSize = 11
GameTitleLabel.TextXAlignment = Enum.TextXAlignment.Left
GameTitleLabel.TextTruncate = Enum.TextTruncate.AtEnd
GameTitleLabel.Parent = InfoCard

-- Container ID Row
local IdRow = Instance.new("Frame")
IdRow.Size = UDim2.new(1, -70, 0, 18)
IdRow.Position = UDim2.new(0, 68, 0, 24)
IdRow.BackgroundTransparency = 1
IdRow.Parent = InfoCard

local IdLayout = Instance.new("UIListLayout")
IdLayout.Parent = IdRow
IdLayout.FillDirection = Enum.FillDirection.Horizontal
IdLayout.SortOrder = Enum.SortOrder.LayoutOrder
IdLayout.VerticalAlignment = Enum.VerticalAlignment.Center
IdLayout.Padding = UDim.new(0, 5)

local GameIdLabel = Instance.new("TextLabel")
GameIdLabel.LayoutOrder = 1
GameIdLabel.Text = "ID: " .. game.PlaceId
GameIdLabel.Size = UDim2.new(0, 0, 1, 0)
GameIdLabel.AutomaticSize = Enum.AutomaticSize.X
GameIdLabel.BackgroundTransparency = 1
GameIdLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
GameIdLabel.Font = Enum.Font.Gotham
GameIdLabel.TextSize = 10
GameIdLabel.TextXAlignment = Enum.TextXAlignment.Left
GameIdLabel.Parent = IdRow

local CopyIdBtn = Instance.new("ImageButton")
CopyIdBtn.LayoutOrder = 2
CopyIdBtn.Name = "CopyIdBtn"
CopyIdBtn.Image = "rbxassetid://90434151822042"
CopyIdBtn.Size = UDim2.new(0, 14, 0, 14)
CopyIdBtn.BackgroundTransparency = 1
CopyIdBtn.Parent = IdRow

CopyIdBtn.MouseButton1Click:Connect(function()
    setclipboard(tostring(game.PlaceId))
    CopyIdBtn.ImageColor3 = Color3.fromRGB(0, 255, 0)
    task.wait(0.5)
    CopyIdBtn.ImageColor3 = Color3.fromRGB(255, 255, 255)
end)

-- Container Dev Row
local DevRow = Instance.new("Frame")
DevRow.Size = UDim2.new(1, -70, 0, 18)
DevRow.Position = UDim2.new(0, 68, 0, 42)
DevRow.BackgroundTransparency = 1
DevRow.Parent = InfoCard

local DevLayout = Instance.new("UIListLayout")
DevLayout.Parent = DevRow
DevLayout.FillDirection = Enum.FillDirection.Horizontal
DevLayout.SortOrder = Enum.SortOrder.LayoutOrder
DevLayout.VerticalAlignment = Enum.VerticalAlignment.Center
DevLayout.Padding = UDim.new(0, 5)

local DevLabel = Instance.new("TextLabel")
DevLabel.LayoutOrder = 1
DevLabel.Text = "Dev: ..."
DevLabel.Size = UDim2.new(0, 0, 1, 0)
DevLabel.AutomaticSize = Enum.AutomaticSize.X
DevLabel.BackgroundTransparency = 1
DevLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
DevLabel.Font = Enum.Font.Gotham
DevLabel.TextSize = 10
DevLabel.TextXAlignment = Enum.TextXAlignment.Left
DevLabel.Parent = DevRow

local CopyDevBtn = Instance.new("ImageButton")
CopyDevBtn.LayoutOrder = 2
CopyDevBtn.Name = "CopyDevBtn"
CopyDevBtn.Image = "rbxassetid://90434151822042"
CopyDevBtn.Size = UDim2.new(0, 14, 0, 14)
CopyDevBtn.BackgroundTransparency = 1
CopyDevBtn.Parent = DevRow

task.spawn(function()
    pcall(function()
        local info = MarketplaceService:GetProductInfo(game.PlaceId)
        GameTitleLabel.Text = info.Name
        local devName = info.Creator and info.Creator.Name or "Unknown"
        DevLabel.Text = "Dev: " .. devName
        
        CopyDevBtn.MouseButton1Click:Connect(function()
            setclipboard(devName)
            CopyDevBtn.ImageColor3 = Color3.fromRGB(0, 255, 0)
            task.wait(0.5)
            CopyDevBtn.ImageColor3 = Color3.fromRGB(255, 255, 255)
        end)
    end)
end)

-- >> TOOLS <<
local function createHeader(text, order)
    local l = Instance.new("TextLabel");
    l.LayoutOrder = order; l.Text = text; l.Size = UDim2.new(1, 0, 0, 18); l.BackgroundTransparency = 1; l.TextColor3 = Color3.fromRGB(255, 255, 255);
    l.Font = Enum.Font.GothamBlack; l.TextSize = 9; l.TextXAlignment = Enum.TextXAlignment.Left; l.Parent = RightPanel
end
local function createBtn(text, order, color, callback)
    local b = Instance.new("TextButton");
    b.LayoutOrder = order; b.Text = text; b.Size = UDim2.new(1, 0, 0, 28); b.BackgroundColor3 = color; b.TextColor3 = Color3.fromRGB(255, 255, 255);
    b.Font = Enum.Font.GothamSemibold; b.TextSize = 11; b.Parent = RightPanel; local c = Instance.new("UICorner"); c.CornerRadius = UDim.new(0, 8);
    c.Parent = b
    b.MouseButton1Click:Connect(callback)
    return b
end
local function createTextBox(placeholder, order)
    local t = Instance.new("TextBox");
    t.LayoutOrder = order; t.PlaceholderText = placeholder; t.Text = ""; t.Size = UDim2.new(1, 0, 0, 28); t.BackgroundColor3 = Color3.fromRGB(35, 35, 40);
    t.TextColor3 = Color3.fromRGB(255, 255, 255); t.Font = Enum.Font.Gotham; t.TextSize = 11; t.Parent = RightPanel; local c = Instance.new("UICorner");
    c.CornerRadius = UDim.new(0, 8); c.Parent = t
    return t
end

local function createStatusLabel(text, order)
    local l = Instance.new("TextLabel")
    l.LayoutOrder = order; l.Text = text; l.Size = UDim2.new(1, 0, 0, 15); l.BackgroundTransparency = 1; l.TextColor3 = Color3.fromRGB(200, 200, 200);
    l.Font = Enum.Font.Gotham; l.TextSize = 10; l.TextXAlignment = Enum.TextXAlignment.Left; l.Parent = RightPanel
    return l
end

createHeader("SERVER MANAGER", 2)
createBtn("Rejoin Server", 3, Color3.fromRGB(50, 50, 55), function() TeleportService:TeleportToPlaceInstance(game.PlaceId, game.JobId, Player) end)
createBtn("Copy Job ID", 4, Color3.fromRGB(50, 50, 55), function() setclipboard(game.JobId) end)

createHeader("JOIN BY JOB ID", 5)
local JobBox = createTextBox("Job ID...", 6)
createBtn("Join Job ID", 7, Color3.fromRGB(40, 120, 80), function() if JobBox.Text ~= "" then TeleportService:TeleportToPlaceInstance(game.PlaceId, JobBox.Text, Player) end end)

createHeader("SERVER HOP", 8)
createBtn("Hop Low Server", 9, Color3.fromRGB(0, 160, 100), function()
    local PlaceID = game.PlaceId; local AllIDs = {}
    pcall(function()
        local Raw = game:HttpGet("https://games.roblox.com/v1/games/" .. PlaceID .. "/servers/Public?sortOrder=Asc&limit=100")
        local Decode = HttpService:JSONDecode(Raw)
        for _, v in pairs(Decode.data) do if v.playing < v.maxPlayers and v.playing < 5 and v.id ~= game.JobId then table.insert(AllIDs, v.id) end end
    end)
    if #AllIDs > 0 then TeleportService:TeleportToPlaceInstance(PlaceID, AllIDs[math.random(1, #AllIDs)], Player) end
end)
createBtn("Hop Random Server", 10, Color3.fromRGB(140, 0, 215), function()
    local PlaceID = game.PlaceId; local AllIDs = {}
    pcall(function()
        local Raw = game:HttpGet("https://games.roblox.com/v1/games/" .. PlaceID .. "/servers/Public?sortOrder=Asc&limit=100")
        local Decode = HttpService:JSONDecode(Raw)
        for _, v in pairs(Decode.data) do if v.playing < v.maxPlayers and v.id ~= game.JobId then table.insert(AllIDs, v.id) end end
    end)
    if #AllIDs > 0 then TeleportService:TeleportToPlaceInstance(PlaceID, AllIDs[math.random(1, #AllIDs)], Player) end
end)

createBtn("HOP GOOD MS", 11, Color3.fromRGB(200, 140, 0), function()
    local PlaceID = game.PlaceId; local AllIDs = {}
    pcall(function()
        local Raw = game:HttpGet("https://games.roblox.com/v1/games/" .. PlaceID .. "/servers/Public?sortOrder=Desc&limit=100")
        local Decode = HttpService:JSONDecode(Raw)
        for _, v in pairs(Decode.data) do 
            if v.playing < (v.maxPlayers - 2) and v.id ~= game.JobId then table.insert(AllIDs, v.id) end 
        end
    end)
    if #AllIDs > 0 then 
        TeleportService:TeleportToPlaceInstance(PlaceID, AllIDs[math.random(1, math.min(#AllIDs, 5))], Player) 
    end
end)

-- == STATUS LOGIC ==
createHeader("STATUS", 12)
local TimeLabel = createStatusLabel("Jam: ...", 13)
local StayLabel = createStatusLabel("Stay in server: 00:00:00", 14)
local RegionLabel = createStatusLabel("Server Region: Detect...", 15)
local PingLabel = createStatusLabel("Ping: ...", 16)
local FpsLabel = createStatusLabel("Fps: ...", 17)
local LoadLabel = createStatusLabel("Load: ...", 18) -- [BARU] Load Asset/Memory

-- FPS Counter Variable
local FPS = 0
RunService.RenderStepped:Connect(function()
    FPS = FPS + 1
end)

local joinTime = tick()
task.spawn(function()
    local region = "Unknown"
    pcall(function()
        local data = HttpService:JSONDecode(game:HttpGet("http://ip-api.com/json/"))
        region = data.countryCode or data.country or "Unknown"
    end)
    RegionLabel.Text = "Server Region: " .. region
    
    while true do
        -- Update Jam
        TimeLabel.Text = "Jam: " .. os.date("%H:%M:%S")
        
        -- Update Stay Time
        local diff = tick() - joinTime
        local h, m, s = math.floor(diff / 3600), math.floor((diff % 3600) / 60), math.floor(diff % 60)
        StayLabel.Text = string.format("Stay in server: %02d:%02d:%02d", h, m, s)
        
        -- Update Ping
        local pingValue = 0
        pcall(function()
            pingValue = math.floor(Stats.Network.ServerStatsItem["Data Ping"]:GetValue())
        end)
        PingLabel.Text = "Ping: " .. pingValue .. " ms"
        
        -- Update FPS
        FpsLabel.Text = "Fps: " .. FPS
        FPS = 0 
        
        -- [BARU] Update Load (Memory)
        local mem = math.floor(Stats:GetTotalMemoryUsageMb())
        LoadLabel.Text = "Load: " .. mem .. " MB"
        
        task.wait(1)
    end
end)

-- == 6. INTERACTIVE CHARACTER ==
local function updateCharacter()
    for _, v in pairs(WorldModel:GetChildren()) do v:Destroy() end
    local char = Player.Character or Player.CharacterAdded:Wait()
    char.Archivable = true; local clone = char:Clone();
    clone.Parent = WorldModel
    clone:SetPrimaryPartCFrame(CFrame.new(0, 0, 0))
    for _, item in pairs(clone:GetDescendants()) do if item:IsA("Script") or item:IsA("LocalScript") or item:IsA("Sound") then item:Destroy() end end
end
task.spawn(updateCharacter)

local isDragging, prevX, rotX, zoom = false, 0, 0, 5
VPContainer.InputBegan:Connect(function(input) if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then isDragging = true; prevX = input.Position.X end end)
VPContainer.InputEnded:Connect(function() isDragging = false end)
VPContainer.InputChanged:Connect(function(input)
    if isDragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        local delta = input.Position.X - prevX; rotX = rotX - (delta * 0.01); prevX = input.Position.X
    end
end)
RunService.RenderStepped:Connect(function()
    local camPos = CFrame.Angles(0, rotX, 0) * CFrame.new(0, 1.5, -zoom)
    Camera.CFrame = CFrame.new(camPos.Position, Vector3.new(0, 1.5, 0))
end)

UserInputService.InputBegan:Connect(function(input, gpe)
    if not gpe and input.KeyCode == Enum.KeyCode.RightControl then
        STSServerUI.Enabled = not STSServerUI.Enabled
    end
end)
