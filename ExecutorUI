local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local Player = Players.LocalPlayer

--// Anti Delete
local function protectUI(gui)
	local connection
	connection = gui.AncestryChanged:Connect(function(_, parent)
		if not parent then
			pcall(function() connection:Disconnect() end) 
			gui.Parent = Player:WaitForChild("PlayerGui") 
		end
	end)
end

--// Hapus versi lama
local old = Player:WaitForChild("PlayerGui"):FindFirstChild("ExecutorUI")
if old then old:Destroy() end

--// ScreenGui
local ExecutorUI = Instance.new("ScreenGui")
ExecutorUI.Name = "ExecutorUI"
ExecutorUI.DisplayOrder = 9999
ExecutorUI.ResetOnSpawn = false
ExecutorUI.ZIndexBehavior = Enum.ZIndexBehavior.Global
ExecutorUI.IgnoreGuiInset = true
ExecutorUI.Enabled = false -- Saya set True biar langsung kelihatan pas di-run
ExecutorUI.Parent = Player:WaitForChild("PlayerGui")

--// Frame Utama (UKURAN DIKECILIN)
local bg = Instance.new("Frame")
bg.Size = UDim2.new(0, 400, 0, 240) -- Ukuran lebih compact
bg.AnchorPoint = Vector2.new(0.5, 0.5)
bg.Position = UDim2.new(0.5, 0, 0.5, 0)
bg.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
bg.BackgroundTransparency = 0.1
bg.BorderSizePixel = 0
bg.Parent = ExecutorUI

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 10) -- Corner radius lebih kecil biar pas
corner.Parent = bg

--// Title
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, -60, 0, 25)
title.Position = UDim2.new(0, 15, 0, 8)
title.BackgroundTransparency = 1
title.Font = Enum.Font.GothamBold
title.Text = "Executor"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextSize = 14 -- Teks lebih kecil
title.TextXAlignment = Enum.TextXAlignment.Left
title.Parent = bg

--// Tombol X (Close)
local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.new(0, 20, 0, 20)
closeBtn.Position = UDim2.new(1, -28, 0, 8)
closeBtn.BackgroundTransparency = 1
closeBtn.Text = "x"
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextSize = 16
closeBtn.TextColor3 = Color3.new(1, 1, 1)
closeBtn.Parent = bg

closeBtn.MouseButton1Click:Connect(function()
	ExecutorUI.Enabled = false
end)

--// Scrolling Frame
local scroll = Instance.new("ScrollingFrame")
scroll.Size = UDim2.new(1, -30, 1, -85) -- Ukuran area ketik disesuaikan
scroll.Position = UDim2.new(0, 15, 0, 40)
scroll.BackgroundColor3 = Color3.fromRGB(15, 15, 20)
scroll.BackgroundTransparency = 0.3
scroll.ScrollBarThickness = 4 -- Scrollbar lebih tipis biar gak ganggu
scroll.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 255)
scroll.ScrollingDirection = Enum.ScrollingDirection.XY
scroll.AutomaticCanvasSize = Enum.AutomaticSize.XY
scroll.BorderSizePixel = 0
scroll.Parent = bg

local scrollCorner = Instance.new("UICorner")
scrollCorner.CornerRadius = UDim.new(0, 8)
scrollCorner.Parent = scroll

--// TextBox (Area Ketik)
local input = Instance.new("TextBox")
input.Size = UDim2.new(1, 0, 1, 0) 
input.BackgroundTransparency = 1
input.ClearTextOnFocus = false
input.MultiLine = true
input.TextWrapped = false
input.AutomaticSize = Enum.AutomaticSize.XY
input.TextXAlignment = Enum.TextXAlignment.Left
input.TextYAlignment = Enum.TextYAlignment.Top
input.Font = Enum.Font.Code
input.TextSize = 13 -- Teks code diperkecil sedikit
input.TextColor3 = Color3.fromRGB(240, 240, 240)
input.PlaceholderText = "-- Paste script..."
input.Text = "" 
input.Parent = scroll

local pad = Instance.new("UIPadding")
pad.PaddingLeft = UDim.new(0, 5)
pad.PaddingTop = UDim.new(0, 5)
pad.Parent = input

--// Tombol RUN (DIKECILIN)
local runBtn = Instance.new("ImageButton")
runBtn.Size = UDim2.new(0, 45, 0, 45) -- Dari 55 jadi 45
runBtn.AnchorPoint = Vector2.new(0.5, 1)
runBtn.Position = UDim2.new(0.5, 0, 1, -8)
runBtn.BackgroundColor3 = Color3.fromRGB(45, 45, 60)
runBtn.BackgroundTransparency = 0.2
runBtn.Image = "rbxassetid://127467405552658"
runBtn.ImageColor3 = Color3.fromRGB(180, 180, 255)
runBtn.Parent = bg

local btnCorner = Instance.new("UICorner")
btnCorner.CornerRadius = UDim.new(1, 0)
btnCorner.Parent = runBtn

-- Animasi Hover
runBtn.MouseEnter:Connect(function()
	TweenService:Create(runBtn, TweenInfo.new(0.15), {BackgroundTransparency = 0.1, ImageColor3 = Color3.new(1, 1, 1)}):Play()
end)
runBtn.MouseLeave:Connect(function()
	TweenService:Create(runBtn, TweenInfo.new(0.15), {BackgroundTransparency = 0.2, ImageColor3 = Color3.fromRGB(180, 180, 255)}):Play()
end)

-- Notifikasi System
local function notify(msg)
	pcall(function()
		game.StarterGui:SetCore("SendNotification", {
			Title = "Executor",
			Text = msg,
			Duration = 2
		})
	end)
end

-- Run Action
runBtn.MouseButton1Click:Connect(function()
	local tweenIn = TweenService:Create(runBtn, TweenInfo.new(0.1), {Size = UDim2.new(0, 50, 0, 50)})
	local tweenOut = TweenService:Create(runBtn, TweenInfo.new(0.1), {Size = UDim2.new(0, 45, 0, 45)})
	tweenIn:Play()
	tweenIn.Completed:Wait()
	tweenOut:Play()

	local code = input.Text
	if code == "" or code:match("^%s*$") then
		notify("⚠️ Empty!")
		return
	end

	local func, err = loadstring(code)
	if func then
		notify("✅ Executed!")
		task.spawn(func)
	else
		notify("⚠️ Error!")
		warn("Executor Error:", err)
	end
end)

protectUI(ExecutorUI)

Player.CharacterAdded:Connect(function()
	task.wait(0.5)
	if not Player.PlayerGui:FindFirstChild("ExecutorUI") then
		ExecutorUI.Parent = Player:WaitForChild("PlayerGui")
	end
end)
