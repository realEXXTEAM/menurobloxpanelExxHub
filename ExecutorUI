local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local Player = Players.LocalPlayer

--// Anti Delete
local function protectUI(gui)
	local connection
	connection = gui.AncestryChanged:Connect(function(_, parent)
		if not parent then
			pcall(function() connection:Disconnect() end) -- Clean up
			-- Re-parent logic handled by CharacterAdded mostly, 
			-- but valid for immediate parenting issues.
			gui.Parent = Player:WaitForChild("PlayerGui") 
		end
	end)
end

--// Hapus versi lama biar gak numpuk
local old = Player:WaitForChild("PlayerGui"):FindFirstChild("ExecutorUI")
if old then old:Destroy() end

--// ScreenGui
local ExecutorUI = Instance.new("ScreenGui")
ExecutorUI.Name = "ExecutorUI"
ExecutorUI.DisplayOrder = 9999
ExecutorUI.ResetOnSpawn = false
ExecutorUI.ZIndexBehavior = Enum.ZIndexBehavior.Global
ExecutorUI.IgnoreGuiInset = true
ExecutorUI.Enabled = false
ExecutorUI.Parent = Player:WaitForChild("PlayerGui")

--// Frame Utama
local bg = Instance.new("Frame")
bg.Size = UDim2.new(0, 520, 0, 300)
bg.AnchorPoint = Vector2.new(0.5, 0.5)
bg.Position = UDim2.new(0.5, 0, 0.5, 0)
bg.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
bg.BackgroundTransparency = 0.1 -- Sedikit lebih solid biar text jelas
bg.BorderSizePixel = 0
bg.Parent = ExecutorUI

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 14)
corner.Parent = bg

--// Title
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, -60, 0, 30)
title.Position = UDim2.new(0, 20, 0, 10)
title.BackgroundTransparency = 1
title.Font = Enum.Font.GothamBold
title.Text = "Executor"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextSize = 18
title.TextXAlignment = Enum.TextXAlignment.Left
title.Parent = bg

--// Tombol X (Close)
local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.new(0, 25, 0, 25)
closeBtn.Position = UDim2.new(1, -35, 0, 8)
closeBtn.BackgroundTransparency = 1
closeBtn.Text = "X"
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextSize = 18
closeBtn.TextColor3 = Color3.new(1, 1, 1)
closeBtn.Parent = bg

closeBtn.MouseButton1Click:Connect(function()
	ExecutorUI.Enabled = false
end)

--// Scrolling Frame (Container Script)
local scroll = Instance.new("ScrollingFrame")
scroll.Size = UDim2.new(1, -40, 1, -90)
scroll.Position = UDim2.new(0, 20, 0, 45)
scroll.BackgroundColor3 = Color3.fromRGB(15, 15, 20)
scroll.BackgroundTransparency = 0.3
scroll.ScrollBarThickness = 8 -- Sedikit tebal biar gampang di klik
scroll.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 255) -- Warna scrollbar biar keliatan
scroll.ScrollingDirection = Enum.ScrollingDirection.XY -- Bisa scroll atas-bawah & kiri-kanan
scroll.AutomaticCanvasSize = Enum.AutomaticSize.XY -- Canvas ngikutin isi text
scroll.CanvasSize = UDim2.new(0, 0, 0, 0)
scroll.BorderSizePixel = 0
scroll.Parent = bg

local scrollCorner = Instance.new("UICorner")
scrollCorner.CornerRadius = UDim.new(0, 10)
scrollCorner.Parent = scroll

--// TextBox (Area Ketik Script)
local input = Instance.new("TextBox")
-- Size set ke 1,0, 1,0 tapi AutomaticSize akan memperbesar ini sesuai text
input.Size = UDim2.new(1, 0, 1, 0) 
input.Position = UDim2.new(0, 0, 0, 0)
input.BackgroundTransparency = 1
input.ClearTextOnFocus = false
input.MultiLine = true
input.TextWrapped = false -- PENTING: Biar codingan panjang ga turun ke bawah (wrap), tapi manjang ke samping
input.AutomaticSize = Enum.AutomaticSize.XY -- PENTING: Biar TextBox membesar otomatis dan trigger scrollbar
input.TextXAlignment = Enum.TextXAlignment.Left
input.TextYAlignment = Enum.TextYAlignment.Top
input.Font = Enum.Font.Code -- PENTING: Font coding biar spasi/garis lurus
input.TextSize = 15
input.TextColor3 = Color3.fromRGB(240, 240, 240)
input.PlaceholderText = "-- Paste your script here..."
input.Text = "" 
input.Parent = scroll

-- Tambahin padding dikit biar text gak nempel banget sama pinggir scroll
local pad = Instance.new("UIPadding")
pad.PaddingLeft = UDim.new(0, 5)
pad.PaddingTop = UDim.new(0, 5)
pad.PaddingRight = UDim.new(0, 5)
pad.PaddingBottom = UDim.new(0, 5)
pad.Parent = input

--// Tombol RUN
local runBtn = Instance.new("ImageButton")
runBtn.Size = UDim2.new(0, 55, 0, 55)
runBtn.AnchorPoint = Vector2.new(0.5, 1)
runBtn.Position = UDim2.new(0.5, 0, 1, -15)
runBtn.BackgroundColor3 = Color3.fromRGB(45, 45, 60)
runBtn.BackgroundTransparency = 0.2
runBtn.Image = "rbxassetid://127679279592127" -- ▶️
runBtn.ImageColor3 = Color3.fromRGB(180, 180, 255)
runBtn.Parent = bg

local btnCorner = Instance.new("UICorner")
btnCorner.CornerRadius = UDim.new(1, 0)
btnCorner.Parent = runBtn

-- Hover animasi
runBtn.MouseEnter:Connect(function()
	TweenService:Create(runBtn, TweenInfo.new(0.15), {
		BackgroundTransparency = 0.1,
		ImageColor3 = Color3.new(1, 1, 1)
	}):Play()
end)
runBtn.MouseLeave:Connect(function()
	TweenService:Create(runBtn, TweenInfo.new(0.15), {
		BackgroundTransparency = 0.2,
		ImageColor3 = Color3.fromRGB(180, 180, 255)
	}):Play()
end)

-- Notifikasi System
local function notify(msg)
	pcall(function()
		game.StarterGui:SetCore("SendNotification", {
			Title = "Executor",
			Text = msg,
			Duration = 3
		})
	end)
end

-- Tombol Run action
runBtn.MouseButton1Click:Connect(function()
	-- bubble anim
	local tweenIn = TweenService:Create(runBtn, TweenInfo.new(0.1), {Size = UDim2.new(0, 65, 0, 65)})
	local tweenOut = TweenService:Create(runBtn, TweenInfo.new(0.1), {Size = UDim2.new(0, 55, 0, 55)})
	tweenIn:Play()
	tweenIn.Completed:Wait()
	tweenOut:Play()

	local code = input.Text
	if code == "" or code:match("^%s*$") then
		notify("⚠️ Enter the script first!")
		return
	end

	-- Eksekusi Script (Loadstring)
	local func, err = loadstring(code)
	if func then
		notify("✅ Script Executed!")
		task.spawn(func)
	else
		notify("⚠️ Error: "..tostring(err))
		warn("Executor Error:", err) -- Print ke console (F9) biar lebih jelas
	end
end)

-- Anti delete & Persist
protectUI(ExecutorUI)

-- Biar UI tetap ada pas mati/respawn
Player.CharacterAdded:Connect(function()
	task.wait(0.5)
	if not Player.PlayerGui:FindFirstChild("ExecutorUI") then
		ExecutorUI.Parent = Player:WaitForChild("PlayerGui")
	end
end)


